package in.testpress.models.greendao;

import org.greenrobot.greendao.annotation.*;

import java.util.List;
import in.testpress.models.greendao.DaoSession;
import org.greenrobot.greendao.DaoException;

import in.testpress.util.IntegerList;

// THIS CODE IS GENERATED BY greenDAO, EDIT ONLY INSIDE THE "KEEP"-SECTIONS

// KEEP INCLUDES - put your custom includes here
import java.util.ArrayList;
import java.util.List;

import android.content.Context;
import android.os.Parcel;

import com.google.gson.annotations.SerializedName;

import in.testpress.core.TestpressSDKDatabase;
import in.testpress.util.WebViewUtils;
// KEEP INCLUDES END

/**
 * Entity mapped to table "REVIEW_ITEM".
 */
@Entity(active = true)
public class ReviewItem {

    @Id
    private Long id;
    private Integer index;
    private String url;
    private Integer order;
    private String duration;
    private String bestDuration;
    private String averageDuration;
    private String essayText;
    private String essayTopic;

    @SerializedName(value="selected_answer_ids", alternate={"selected_answers"})
    @Convert(converter = in.testpress.util.IntegerListConverter.class, columnType = String.class)
    private IntegerList selectedAnswers;
    private Boolean review;
    private Integer commentsCount;
    private Integer correctPercentage;
    private Long bookmarkId;
    private String marks;
    private String shortText;
    private String result;
    private Long attemptId;
    private Long questionId;

    /** Used to resolve relations */
    @Generated
    private transient DaoSession daoSession;

    /** Used for active entity operations. */
    @Generated
    private transient ReviewItemDao myDao;

    @ToOne(joinProperty = "questionId")
    private ReviewQuestion question;

    @Generated
    private transient Long question__resolvedKey;

    @ToMany(joinProperties = {
        @JoinProperty(name = "id", referencedName = "reviewItemId")
    })
    private List<UserUploadedFile> files;

    // KEEP FIELDS - put your custom fields here
    public static final String ANSWERED_CORRECT = "Correct";
    public static final String ANSWERED_INCORRECT = "Incorrect";
    public static final String UNANSWERED = "Unanswered";
    // KEEP FIELDS END

    @Generated
    public ReviewItem() {
    }

    public ReviewItem(Long id) {
        this.id = id;
    }

    @Generated
    public ReviewItem(Long id, Integer index, String url, Integer order, String duration, String bestDuration, String averageDuration, String essayText, String essayTopic, IntegerList selectedAnswers, Boolean review, Integer commentsCount, Integer correctPercentage, Long bookmarkId, String marks, String shortText, String result, Long attemptId, Long questionId) {
        this.id = id;
        this.index = index;
        this.url = url;
        this.order = order;
        this.duration = duration;
        this.bestDuration = bestDuration;
        this.averageDuration = averageDuration;
        this.essayText = essayText;
        this.essayTopic = essayTopic;
        this.selectedAnswers = selectedAnswers;
        this.review = review;
        this.commentsCount = commentsCount;
        this.correctPercentage = correctPercentage;
        this.bookmarkId = bookmarkId;
        this.marks = marks;
        this.shortText = shortText;
        this.result = result;
        this.attemptId = attemptId;
        this.questionId = questionId;
    }

    /** called by internal mechanisms, do not call yourself. */
    @Generated
    public void __setDaoSession(DaoSession daoSession) {
        this.daoSession = daoSession;
        myDao = daoSession != null ? daoSession.getReviewItemDao() : null;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public Integer getIndex() {
        return index;
    }

    public void setIndex(Integer index) {
        this.index = index;
    }

    public String getUrl() {
        return url;
    }

    public void setUrl(String url) {
        this.url = url;
    }

    public Integer getOrder() {
        return order;
    }

    public void setOrder(Integer order) {
        this.order = order;
    }

    public String getDuration() {
        return duration;
    }

    public void setDuration(String duration) {
        this.duration = duration;
    }

    public String getBestDuration() {
        return bestDuration;
    }

    public void setBestDuration(String bestDuration) {
        this.bestDuration = bestDuration;
    }

    public String getAverageDuration() {
        return averageDuration;
    }

    public void setAverageDuration(String averageDuration) {
        this.averageDuration = averageDuration;
    }

    public String getEssayText() {
        return essayText;
    }

    public void setEssayText(String essayText) {
        this.essayText = essayText;
    }

    public String getEssayTopic() {
        return essayTopic;
    }

    public void setEssayTopic(String essayTopic) {
        this.essayTopic = essayTopic;
    }

    public IntegerList getSelectedAnswers() {
        return selectedAnswers;
    }

    public void setSelectedAnswers(IntegerList selectedAnswers) {
        this.selectedAnswers = selectedAnswers;
    }

    public Boolean getReview() {
        return review;
    }

    public void setReview(Boolean review) {
        this.review = review;
    }

    public Integer getCommentsCount() {
        return commentsCount;
    }

    public void setCommentsCount(Integer commentsCount) {
        this.commentsCount = commentsCount;
    }

    public Integer getCorrectPercentage() {
        return correctPercentage;
    }

    public void setCorrectPercentage(Integer correctPercentage) {
        this.correctPercentage = correctPercentage;
    }

    public Long getBookmarkId() {
        return bookmarkId;
    }

    public void setBookmarkId(Long bookmarkId) {
        this.bookmarkId = bookmarkId;
    }

    public String getMarks() {
        return marks;
    }

    public void setMarks(String marks) {
        this.marks = marks;
    }

    public String getShortText() {
        return shortText;
    }

    public void setShortText(String shortText) {
        this.shortText = shortText;
    }

    public String getResult() {
        return result;
    }

    public void setResult(String result) {
        this.result = result;
    }

    public Long getAttemptId() {
        return attemptId;
    }

    public void setAttemptId(Long attemptId) {
        this.attemptId = attemptId;
    }

    public Long getQuestionId() {
        return questionId;
    }

    public void setQuestionId(Long questionId) {
        this.questionId = questionId;
    }

    /** To-one relationship, resolved on first access. */
    @Generated
    public ReviewQuestion getQuestion() {
        Long __key = this.questionId;
        if (question__resolvedKey == null || !question__resolvedKey.equals(__key)) {
            __throwIfDetached();
            ReviewQuestionDao targetDao = daoSession.getReviewQuestionDao();
            ReviewQuestion questionNew = targetDao.load(__key);
            synchronized (this) {
                question = questionNew;
            	question__resolvedKey = __key;
            }
        }
        return question;
    }

    @Generated
    public void setQuestion(ReviewQuestion question) {
        synchronized (this) {
            this.question = question;
            questionId = question == null ? null : question.getId();
            question__resolvedKey = questionId;
        }
    }

    /** To-many relationship, resolved on first access (and after reset). Changes to to-many relations are not persisted, make changes to the target entity. */
    @Generated
    public List<UserUploadedFile> getFiles() {
        if (files == null) {
            __throwIfDetached();
            UserUploadedFileDao targetDao = daoSession.getUserUploadedFileDao();
            List<UserUploadedFile> filesNew = targetDao._queryReviewItem_Files(id);
            synchronized (this) {
                if(files == null) {
                    files = filesNew;
                }
            }
        }
        return files;
    }

    /** Resets a to-many relationship, making the next get call to query for a fresh result. */
    @Generated
    public synchronized void resetFiles() {
        files = null;
    }

    /**
    * Convenient call for {@link org.greenrobot.greendao.AbstractDao#delete(Object)}.
    * Entity must attached to an entity context.
    */
    @Generated
    public void delete() {
        __throwIfDetached();
        myDao.delete(this);
    }

    /**
    * Convenient call for {@link org.greenrobot.greendao.AbstractDao#update(Object)}.
    * Entity must attached to an entity context.
    */
    @Generated
    public void update() {
        __throwIfDetached();
        myDao.update(this);
    }

    /**
    * Convenient call for {@link org.greenrobot.greendao.AbstractDao#refresh(Object)}.
    * Entity must attached to an entity context.
    */
    @Generated
    public void refresh() {
        __throwIfDetached();
        myDao.refresh(this);
    }

    @Generated
    private void __throwIfDetached() {
        if (myDao == null) {
            throw new DaoException("Entity is detached from DAO context");
        }
    }

    // KEEP METHODS - put your custom methods here
    public ReviewQuestion getRawQuestion() {
        if (myDao == null || question != null) {
            return question;
        }
        return getQuestion();
    }

    public static void save(Context context, List<ReviewItem> reviewItems) {
        ReviewItemDao reviewItemDao = TestpressSDKDatabase.getReviewItemDao(context);
        for (int i = 0; i < reviewItems.size(); i++) {
            ReviewItem reviewItem = reviewItems.get(i);
            List<ReviewItem> reviewItemsFromDB = reviewItemDao.queryBuilder()
                    .where(ReviewItemDao.Properties.Id.eq(reviewItem.getId())).list();

            if (reviewItemsFromDB.isEmpty()) {
                reviewItemDao.insertOrReplace(reviewItem);
            }
        }
    }

    public String getAttemptedAnswersDisplayHtml() {
        String html = "<div style='display:box; display:-webkit-box; margin-bottom:10px;'>" +
                WebViewUtils.getHeadingTags("Your Answer");

        List<ReviewAnswer> answers = question.getAnswers();
        for (int j = 0; j < answers.size(); j++) {
            ReviewAnswer attemptAnswer = answers.get(j);
            if (selectedAnswers.contains(attemptAnswer.getId().intValue())) {
                html += "\n" + WebViewUtils.getCorrectAnswerIndexWithTags(j);
            }
        }
        html += "</div>";

        return html;
    }
    // KEEP METHODS END

}
